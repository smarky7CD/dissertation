\noindent Like CMS, an instance of the HeavyKeeper data structure is parameterized by positive integers $k,m$, and a function $R\colon \keys\times\set{U}\to[m]^k$; in addition, it is parameterized by real-valued~$d \in (0,1]$, and \emph{fingerprinting function} $T\colon\keys\times\set{U}\to\bits^n$ for some fixed $n>0$.
The HK structure (see the pseudocode in Figure~\ref{fig:hk}) maintains a $k \times m$ matrix~$A$. However, each $A[i][j]$ holds a pair $(\mathrm{fp},\mathrm{cnt})$, initialized as~$(\star,0)$ where $\star$ is a distinguished symbol.  Informally, for a given stream~$\streamvar{S}$, any $z \in \streamvar{S}$ such that $A[i][j].\fp=T(K,z)$ is an \emph{owner} of this position; there may be more than one such owner at a time, if $T(K,\cdot)$ admits many collisions. Ownership can change as a stream is processed: if some~$y$ arrives whose fingerprint is different than that of the current owner(s), then the current (positive) value~$c$ of $A[i][j].\cnt$ is decremented with probability $d^{-c}$.  Loosely, decrementing~$c$ is akin to $A[i][j]$ ``forgetting'' a prior arrival of its current owner(s); with this viewpoint, the value of $A[i][j].\cnt$ is the number of times that this position ``remembers'' seeing its current owner(s).  If~$y$ causes that number to become zero, then it becomes an owner: the stored fingerprint is changed to $\fp_y=T(K,y)$, and the counter is set to 1.  Note that for CMS, $M[i][j]$ ``remembers" the total number of elements that it observed, but nothing about \emph{which} elements.  This observation will motivate our Count-Keeper structure, later on.

The HK provides frequency estimates via point-queries. Writing $(p_1,\allowbreak{\ldots}, p_k) \gets\, R(K,x)$ and~$\fp_x {\gets}\, T(K,x)$, a point-query for $x$ returns
$
{\max}\left\{A[i][p_i].\cnt{\given}\, A[i][p_i].\mathrm{fp}{=}\,\fp_x{,}\, i{\in}\, [k]\right\}
$, i.e., the largest counter value among those positions in~$A$ that ``remember" having seen~$x$.  If that set is empty, the point-query returns 0. 

Yang et al.\cite{yang2019heavykeeper} do state a probabilistic guarantee on the size of estimation errors, under an assumption that each $A[i][j]$ has one and only one owner for the duration of the stream, but the statement is insufficiently precise and its proof is flawed, so we will not quote it.  In the full version of our paper~\cite{cfe_full_version}, we recover a meaningful result (under their assumptions).