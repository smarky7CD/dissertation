In this section, we outline some countermeasures that limit the effectiveness of our attacks. For remarks on the Bloom filter and Cuckoo filter we again refer the reader to~\cite{cryptoeprint:2024/1312}.

Protecting the count-min sketch and Top-K against frequency estimation attacks is challenging. Recall, that both the count-,in sketch and the Top-K are a class of probabilistic data structures called compact frequency estimators (CFE). In~\Cref{chap:cfe} we explore both of these structures in detail, and show that even when switching the hash functions to a keyed primitive (e.g. a PRF) and keeping the internal state of the structure efficient attacks that cause massive frequency estimation errors are still possible~\cite{markelon23}. That is the leakage from insertions and queries to a black-boxed structure is sufficient to carry out the style of attacks we present in this paper. The choices of Redis make these attacks easier to carry out, but findings are negative in any case. 

It is of great interest to explore secure CPDS for frequency estimate queries that are tenable for real world applications. One could of course disallow queries to the structure, or use some public-key infrastructure to only allow insertions from authenticated parties. However, this clearly limits both the usability and performance. Another possibility is to explore new ways of constructing frequency estimation PDS, such as the Count-Keeper introduced in~\cite{markelon23}. While this structure remains susceptible to the types of attacks we present here, they are less effective, and the Count-Keeper has a native ability to flag suspicious frequency estimates. 


