\chapter{Provably Robust Skipping-based Probabilistic Data Structures}

Probabilistic data structures (PDS), such as hash tables, Bloom filters, and skip lists, are widely implemented due to their memory efficiency and favorable operational time complexity, making them essential tools for cost-effective, scalable data processing in resource-constrained environments. Industry adoption of these structures is extensive and growing: Redis, an open-source in-memory data structure store, leverages HyperLogLog for cardinality estimation and Bloom filters for membership testing, achieving superior performance in high-volume deployments at Twitter, Pinterest, and other large internet companies~\cite{redis}. Similarly, Nowack et al. demonstrated enhanced scalability in Discord's server member management through skip list-based implementations~\cite{discord}, Prout et al. utilized skip lists for relational database indexing~\cite{singlestore}, while Schanck et al. reported significant cost reductions in Mozilla Firefox's certificate revocation checking using the novel Clubcard PDS~\cite{clubcard}. Despite their widespread application, analyses of these structures' behavior under adversarial conditions remain notably sparse in the literature. This gap is significant because these data structures frequently operate in contexts where malicious actors might deliberately manipulate inputs to induce erroneous outputs or degrade the performance of these structures.

Compressing probabilistic data structures (CPDS), such as Bloom filters, HyperLogLog, count-min sketch, etc., provide compact (sublinear) representations of potentially large collections of data and support a small set of queries that can be answered efficiently. These space and (by extension) performance gains come at the expense of correctness.  Specifically, CPDS query responses are computed over the compact representation of the data, as opposed to the complete data.  As a result, CPDS query responses are only guaranteed to be \emph{close} to the true answer with \emph{large} probability, where \emph{close} and \emph{large} are typically functions of structure parameters (e.g., the representation size) and properties of the data. These guarantees are stated under the assumption that the data and the internal randomness of the PDS are independent. Informally, this is tantamount to assuming that the entire collection of data is (or can be) determined \emph{before} the PDS makes any random choices.  For many PDS, this amounts to the sampling of hash functions, as the PDS operates deterministically afterward.

Recent research \cite{naor2015bloom, clayton2019, FPUV22, PatersonR22, markelon23, cryptoeprint:2024/1312, filic2025deletions} shows that, under adversarial conditions, these errors for a variety of CPDS can be exacerbated significantly, potentially undermining the reliability of systems that rely on these structures in critical or adversarial contexts. Some of these works also explore applying provable security techniques to these structures, in turn providing robust versions of these structures with respect to correctness in adversarial environments. 

A distinct subset of probabilistic data structures, which ensures correctness (and hence are not compressing) while offering fast probabilistic runtime guarantees, have received considerably less attention in the literature. Existing security analyses, such as those addressing the robustness of hash tables \cite{CrosbyW03, aumasson2012hash, bar2007remote, eckhoff2009hash,klink2011efficient,bottinelli2025hash} and skip lists \cite{nussbaum2019skiplist}, provide valuable insights but lack formal adversarial models and rigorous security analyses. Due to their runtime properties, we refer to these as \emph {probabilistic skipping-based data structures} (PSDS), as they inherently ``skip'' over parts of their internal structure to accelerate lookup operations.
The lack of research in this area is particularly concerning given that the studies on hash tables have already uncovered practical attacks, including methods to mount denial-of-service attacks attacks against intrusion detection systems~\cite{bar2007remote}, web application servers \cite{klink2011efficient}, and the QUIC protocol~\cite{bottinelli2025hash}.


%-------------------------------------------------------------------------------
\section{Relation to Previous Work}
\input{chapters/ch5_skipping/ch5_sections/prev_work.tex}
%-------------------------------------------------------------------------------

%-------------------------------------------------------------------------------
\section{Structures we Analyze}
\input{chapters/ch5_skipping/ch5_sections/structures.tex}
%-------------------------------------------------------------------------------

%-------------------------------------------------------------------------------
\section{Unifying Probabilistic Skipping-Based Data Structures}
\input{chapters/ch5_skipping/ch5_sections/psds.tex}
%-------------------------------------------------------------------------------

%-------------------------------------------------------------------------------
\section{A Security Model for Probabilistic Skipping-Based Structures}
\input{chapters/ch5_skipping/ch5_sections/security_model.tex}
%-------------------------------------------------------------------------------

%-------------------------------------------------------------------------------
\section{Robust Hash Tables}\label{sec:ht}
\input{chapters/ch5_skipping/ch5_sections/rht.tex}
%-------------------------------------------------------------------------------

%-------------------------------------------------------------------------------
\section{Robust Skip Lists}\label{sec:skiplist}
\input{chapters/ch5_skipping/ch5_sections/rsl.tex}
%-------------------------------------------------------------------------------

%-------------------------------------------------------------------------------
\section{Robust Treaps}\label{sec:treaps}
\input{chapters/ch5_skipping/ch5_sections/rtr.tex}
%-------------------------------------------------------------------------------

%-------------------------------------------------------------------------------
\section{Experimental Results}\label{sec:experimental}
\input{chapters/ch5_skipping/ch5_sections/experiments.tex}
%-------------------------------------------------------------------------------