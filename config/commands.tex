\usepackage{natbib}
\usepackage{amssymb}
\usepackage{amsmath,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{float}
\usepackage{textcomp}
\usepackage[symbol]{footmisc}
\usepackage{xcolor}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

% Formatting and common macros for crypto papers. Include this first.
\usepackage{graphics}
\usepackage[font={small}]{caption}
\usepackage{hyperref}
\usepackage[capitalise]{cleveref}
\usepackage{xspace}
\usepackage{sidecap}
\usepackage{amsthm}
%\newtheorem{lemma}{Lemma}
%\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem{definition}{Definition}
\newtheorem{remark}{Remark}
\newcommand{\missingqed}{}
\usepackage{pifont}
\usepackage{parskip}
\usepackage{multirow}
\usepackage{array}
\usepackage{enumitem}
\usepackage[normalem]{ulem}
\useunder{\uline}{\ul}{}
%\usepackage{slashbox}
%\usepackage[table]{xcolor}
\usepackage{framed}
\usepackage[
	% lambda,
	landau,
	% operators,
	% probability,
	% sets,
	% logic,
	% complexity,
	% asymptotics
]{cryptocode}
\usepackage{thmtools, thm-restate}
\usepackage{adjustbox}
\newcommand\Wider[2][3em]{%
	\makebox[\linewidth][c]{%
		\begin{minipage}{\dimexpr\textwidth+#1\relax}
			\raggedright#2
		\end{minipage}%
	}%
}

% Editorial
\renewcommand{\paragraph}[1]{\smallskip\noindent\textbf{#1}.}
\newcommand{\heading}[1]{\paragraph{#1}}
\newcommand{\ala}{{a la}\xspace}
\newcommand{\etal}{{et al.}\xspace}
\newcommand{\viceversa}{{vice versa}\xspace}
\newcommand{\ignore}[1]{}

% Fonts for various types
\newcommand{\notionfont}[1]{{#1}}
\newcommand{\varfont}[1]{\textit{#1}}
\newcommand{\flagfont}[1]{\mathsf{#1}}
\newcommand{\vectorfont}[1]{\vec{#1}}
\newcommand{\oraclefont}[1]{\cryptofont{#1}}
\newcommand{\schemefont}[1]{\textnormal{\textsc{#1}}}
\newcommand{\expfont}[1]{{{\tiny\MakeLowercase{\textnormal{#1}}}}}
\newcommand{\procfont}[1]{\mathsf{#1}}
\newcommand{\algorithmfont}[1]{\mathcal{#1}}
\newcommand{\adversaryfont}[1]{\mathcal{#1}}
\newcommand{\setfont}[1]{\mathcal{#1}}
\newcommand{\cryptofont}[1]{\textup{\textbf{#1}}\hspace{0.5pt}}
\newcommand{\capgreekfont}[1]{\mathrm{#1}}
\newcommand{\pcgraycomment}[1]{\textcolor{gray}{\pclinecomment{\text{#1}}}}

% Crypto functions
\newcommand{\Exp}[1]{\cryptofont{Exp}^{\expfont{#1}}}
\newcommand{\Adv}[1]{\cryptofont{Adv}^{\expfont{#1}}}
\newcommand{\Atk}[1]{\cryptofont{Atk}^{\expfont{#1}}}

% Math
\DeclareMathAlphabet\mathbfcal{OMS}{cmsy}{b}{n}
\newcommand{\dqed}{\hfill$\Diamond$}
\def\ceil(#1){\left\lceil #1 \right\rceil}
\def\floor(#1){\left\lfloor #1 \right\rfloor}
\newcommand{\goesto}{{\rightarrow}}
\newcommand{\Func}{\mathrm{Func}}
\newcommand{\cmark}{\ding{51}}
\newcommand{\xmark}{\ding{55}}

% - Sets
\newcommand{\setify}[1]{\procfont{set}\left(#1\right)}
\newcommand{\setlen}[1]{|#1|}
\newcommand{\multisetlen}[1]{\|#1\|}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\bits}{\{0,1\}}
\newcommand*\bigunion{\bigcup}
\newcommand*\bigintersection{\bigcap}
\newcommand*\union{\cup}
\newcommand{\multiunion}{\uplus}
\newcommand*\intersection{\cap}
\newcommand*\cross{\times}
\newcommand*\by{\cross}
\newcommand{\getsr}{\mathrel{\leftarrow\mkern-14mu\leftarrow}}
%\newcommand{\getsr}{\xleftarrow{\text{\tiny{\$}}}}
%\newcommand{\getsr}{{\:{\leftarrow{\hspace*{-3pt}\raisebox{.75pt}{$\scriptscriptstyle\$$}}}\:}}
\newcommand{\setop}[1]{\mathsf{set}(#1)} %^ \procfont
\def\str(#1){\procfont{set}\left(#1\right)}
\def\bydef{\stackrel{\rm def}{=}}
%\newcommand{\undefn}{\mathtt{undefined}}
\newcommand{\undefn}{\bot}
\newcommand{\univ}{\setfont{U}}
\newcommand{\queries}{\setfont{Q}}
\newcommand{\results}{\setfont{R}}
\newcommand{\mutants}{\setfont{M}}
\newcommand{\keys}{\setfont{K}}
\newcommand{\col}{\setfont{S}}
\newcommand{\zeros}{\mathrm{zeros}}
\newcommand{\setA}{\setfont{A}}
\newcommand{\setB}{\setfont{B}}
\newcommand{\setC}{\setfont{C}}
\newcommand{\setD}{\setfont{D}}
\newcommand{\setI}{\setfont{I}}
\newcommand{\setK}{\setfont{K}}
\newcommand{\setM}{\setfont{M}}
\newcommand{\setN}{\setfont{N}}
\newcommand{\setP}{\setfont{P}}
\newcommand{\setQ}{\setfont{Q}}
\newcommand{\setR}{\setfont{R}}
\newcommand{\setS}{\setfont{S}}
\newcommand{\setT}{\setfont{T}}
\newcommand{\setU}{\setfont{U}}
\newcommand{\setV}{\setfont{V}}
\newcommand{\setX}{\setfont{X}}
\newcommand{\setY}{\setfont{Y}}
\newcommand{\setW}{\setfont{W}}
\newcommand{\setZ}{\setfont{Z}}

% Vectors
\newcommand{\xx}{\vectorfont{x}}
%\newcommand{\vv}{\vectorfont{v}}
\newcommand{\REVO}{\mathbf{Reveal}}
\newcommand{\diffplus}[1]{\fbox{#1}}
\newcommand{\diffplusbox}[1]{\fbox{\parbox{\dimexpr\textwidth-2\fboxsep-2\fboxrule\relax}{#1}}}
\newcommand{\diffminus}[1]{\colorbox{lightgray}{#1}}
\newcommand{\diffminusbox}[1]{\colorbox{lightgray}{\parbox{\dimexpr\textwidth-2\fboxsep-2\fboxrule\relax}{#1}}}
\newcommand{\hh}{\vectorfont{h}}
\newcommand{\fff}{\schemefont{Fn}}
\newcommand{\Rnd}{\schemefont{Rand}}
\newcommand{\Repx}{\Rep1}
\newcommand{\Qryx}{\Qry1}
\newcommand{\Upx}{\Up1}
\newcommand{\Ans}{\varfont{Ans}}
\newcommand{\setE}{\mathcal{E}}
\newcommand{\Resp}{\varfont{Resp}}
%\def\ticks(#1,#2){\procfont{T}_{\hspace*{-1.5pt}#1}({#2})}
\newcommand{\ticks}{\mathsf{T}}
\newcommand{\highlighto}[1]{\colorbox{lightgray}{$\scriptstyle #1$}}
\newcommand{\highlight}[1]{\colorbox{lightgray}{$\displaystyle #1$}}

% - String operations
\newcommand{\emptystr}{\varepsilon}
\newcommand{\cat}{\, \| \,}
\newcommand{\concat}{\cat}
\def\str(#1){\langle #1 \rangle}
\def\substr(#1,#2,#3){#1[#2\mbox{\,:\,}#3]}
\def\toint{\procfont{int}}
\def\tostr{\procfont{str}}
\def\byte(#1){[#1]}

% - Boolean operators
\newcommand*\AND{\wedge}
\newcommand*\OR{\vee}
\newcommand*\NOT{\neg}
\newcommand*\IMPLIES{\implies}
\newcommand*\XOR{\mathbin{\oplus}}
\newcommand*\xor{\XOR}
\newcommand*{\bigor}{\bigvee}

% - Asymptotics
\newcommand{\negl}{\procfont{negl}}
\newcommand{\poly}{\procfont{poly}}

% - Probablity
\newcommand{\E}{\mathrm{E}}
\newcommand{\Prob}[1]{\Pr\hspace{-1pt}\left[\,#1\,\right]}
\newcommand{\prob}[1]{\mathrm{Pr}\left[#1\right]}
\newcommand{\given}{\mid}

% Games
\newcommand{\halt}{\bot}
\newcommand{\game}{\cryptofont{G}}
%\newcommand{\G}{\game}
% \newcommand{\foreach}[3]{$\text{for }#1 \gets #2\text{ to }#3\text{ do}$}
\newcommand{\tab}{\hspace*{10pt}}
\newcommand{\outputs}{=}
\newcommand{\sets}{\,\cryptofont{sets}\,}
\newcommand{\bad}{\varfont{bad}}
\newcommand{\true}{1}
\newcommand{\false}{0}
\newcommand{\invalid}{\bot}
\newcommand{\exception}{\invalid}
\newcommand{\experimentv}[1]{\underline{#1}}
\newcommand{\oraclev}[1]{\underline{{oracle} #1}:}
\newcommand{\adversaryv}[1]{\underline{{adv.} #1}:}
\newcommand{\algorithmv}[1]{\underline{{alg.} #1}:}

% Notions
\newcommand{\errep}{\notionfont{ERR\mbox{-}Pub}}
\newcommand{\erreps}{\notionfont{ERR\mbox{-}Priv}}
\newcommand{\indrep}{\notionfont{IND\mbox{-}UP}}
\newcommand{\indrepr}{\notionfont{IND\mbox{-}UPR}}
\newcommand{\prf}{\notionfont{PRF}}
\newcommand{\ssrep}{\notionfont{SS\mbox{-}REP}}
\def\ssrepX#1{\mbox{\ssrep-#1}}
\newcommand{\owrep}{\notionfont{OW\mbox{-}REP}}
\newcommand{\errepone}{\notionfont{ER\mbox{-}REP1}}
\def\indrepX#1{\indrep\mbox{-}#1}
\def\indreprX#1{\indrepr\mbox{-}#1}
\def\prfX#1{\prf\mbox{-}#1}

% Adversaries
\newcommand{\advA}{\adversaryfont{A}}
\newcommand{\advB}{\adversaryfont{B}}
\newcommand{\advC}{\adversaryfont{C}}
\newcommand{\dist}{\adversaryfont{D}}

% Variables
\newcommand{\err}{\varfont{err}}
\newcommand{\ct}{\varfont{ct}}
\newcommand{\salt}{Z}
\newcommand{\cnt}{\textup{cnt}}
\newcommand{\fp}{\textup{fp}}

% Oracles
\newcommand{\REPO}{\oraclefont{Rep}}
\newcommand{\UPO}{\oraclefont{Up}}
\newcommand{\QRYO}{\oraclefont{Qry}}
\newcommand{\PRFO}{\oraclefont{F}}
\newcommand{\INITO}{\oraclefont{Init}}
\newcommand{\HASHO}{\oraclefont{Hash}}
%\newcommand{\INTO}{\oraclefont{Int}}

% Structures
\newcommand{\ed}{(\epsilon,\delta)}
\newcommand{\struct}{\capgreekfont{\Pi}}
\newcommand{\Init}{\schemefont{Init}}
\newcommand{\Up}{\schemefont{Up}}
\newcommand{\Qry}{\schemefont{Qry}}
\newcommand{\Rep}{\schemefont{Rep}}
\newcommand{\qry}{\procfont{qry}}
\newcommand{\qryin}{\procfont{qry}_{\text{in}}}
\newcommand{\qryout}{\procfont{qry}_{\text{out}}}
\newcommand{\lk}{\procfont{lk}}
\newcommand{\up}{\procfont{up}}
%\newcommand{\pub}{\procfont{pub}}
\newcommand{\pub}{\procfont{repr}}
\newcommand{\repr}{\procfont{repr}}
\newcommand{\pubhash}{\procfont{hashFuncs}}
\newcommand{\param}{\procfont{par}}
\newcommand{\key}{K}
\newcommand{\pp}{\mathit{pp}}
\renewcommand{\sp}{\mathit{sp}}
\newcommand{\ky}{K}
\newcommand{\res}{a}
\newcommand{\elts}{\setfont{X}} % TODO What does "elts" mean?

% Constructions
\newcommand{\BF}{\schemefont{BF}}
\newcommand{\SBF}{\schemefont{SBF}}
\newcommand{\KBF}{\schemefont{KBF}}
\newcommand{\SKBF}{\schemefont{KBF}} % FIXME deprecate
\newcommand{\PRLBF}{\schemefont{PPRL}}
\newcommand{\DICT}{\schemefont{DICT}}
\newcommand{\bloom}{\schemefont{Bloom}}
\newcommand{\bff}{\mathrm{bf}}
\newcommand{\saltybloom}{\mathrm{sbf}}
\newcommand{\prfbloom}{\mathrm{kbf}}
\newcommand{\sketch}{\schemefont{Sketch}}
\newcommand{\CMS}{\schemefont{CMS}}
\newcommand{\HK}{\schemefont{HK}}
\newcommand{\CK}{\schemefont{CK}}
\newcommand{\SCMS}{\schemefont{SCMS}}
\newcommand{\KCMS}{\schemefont{KCMS}}
\newcommand{\countbloom}{\schemefont{Count}}
\newcommand{\dict}{\mathrm{dict}}
\newcommand{\hashbf}{\schemefont{2Hash}}
\newcommand{\hash}{\schemefont{Hash}}
\newcommand{\hashlin}{\schemefont{2Hash}}
\newcommand{\tinyhash}{\schemefont{Tiny}}
\newcommand{\kbf}{\schemefont{KBF}}

% Misc.
\def\v.#1{\boldsymbol{#1}}
\newcommand{\bmap}{{B}}
\newcommand{\cmap}{{B}}
\newcommand{\hw}{{w}}
\newcommand{\id}{\schemefont{id}}

\newcommand{\emptystring}{\varepsilon}

\newcommand{\streamvar}[1]{\vec{#1}}
\newcommand{\set}[1]{\mathcal{#1}}

\newcommand{\myenddef}{\hfill$\blacklozenge$}
\newcommand{\ExpErrFe}[3]{\Atk{\text{err-fe}[#3]}_{#1}(#2)}
\newcommand{\rvcover}{\mathsf{Cover}}
\newcommand{\rvcoverx}[2]{\mathsf{Cover}^{#1}_{#2}}
\newcommand{\rverr}{\mathsf{Err}}
\newcommand{\figref}[1]{Figure~\ref{#1}}
\newcommand{\encode}[1]{\langle #1 \rangle}
